<div class="container page">
  <div *ngIf="!show_add_note_form" class="row">
    <div class="col-md-12">
      <h1 class="mt-3 md-3">Notes</h1>
      <div class="row mt-2">
        <div class="col-12 mt-3">
          <div class="btn-group">
            <button
              [routerLink]="['/disciple']"
              routerLinkActive="router-link-active"
              class="btn btn-sm btn-clear-secondary"
            >
              <i class="fa fa-arrow-left"></i> Back
            </button>
            <!-- <button
              class="btn btn-outline-citric btn-sm"
              (click)="addCategory(form_add_modal, group_category_add_form)"
            >
              <i class="fa fa-plus"></i> Add Category
            </button> -->
          </div>
        </div>
      </div>
    </div>

    <div class="col-12 col-md-4 align-self-end mb-4">
      <div class="form-group" [formGroup]="search_filter_form">
        <label>
          <small class="text-secondary"> Search by type of note </small>
        </label>
        <ng-multiselect-dropdown
          placeholder="Select type of note"
          [data]="categories"
          [settings]="selectCatOptions"
          formControlName="selected_category"
          (onSelect)="getNotes()"
          (onDeSelect)="getNotes()"
        ></ng-multiselect-dropdown>
      </div>
    </div>
    <div class="col-12 col-md-4 text-center">
      <img
        class="disciple_picture"
        [src]="fixUrl(disciple.disciple_picture)"
        alt=""
      />
      <br />
      <h2 class="text-secondary">
        {{ disciple.full_name | uppercase }}
      </h2>
    </div>
    <div class="col-12 col-md-4 align-self-end mb-4">
      <div class="row">
        <div class="col-2 align-self-center">
          <img
            class="discipler_picture"
            [src]="fixUrl(disciple.discipler_picture)"
            alt=""
          />
        </div>
        <div class="col-10 align-self-center">
          ASSIGNED TO
          <br />
          <small class="text-secondary">
            {{ disciple?.discipler_full_name }}
          </small>
        </div>
      </div>
    </div>

    <div class="col-12" *ngFor="let note of notes">
      <div class="row note-container">
        <div class="col-8">
          <h5 class="text-secondary">Note #{{ note.id }}</h5>
          <small>
            {{ note.category_name }}
          </small>
          <br />
          <small class="text-secondary">
            {{ note.created_at | date: "MMM. dd, yyyy hh:mm" }}
          </small>
        </div>
        <div class="col-4">
          <div class="btn-group">
            <button class="btn btn-sm" (click)="editNote(note)">
              <i class="fa fa-edit text-warning"></i>
            </button>
            <button class="btn btn-sm" (click)="deleteItem(note)">
              <i class="fa fa-trash-alt text-danger"></i>
            </button>
          </div>
        </div>
        <div class="col-12">
          <p [innerHTML]="note.content | safe: 'html'"></p>
        </div>
      </div>
    </div>
    <div class="col-12 text-center mb-2">
      <button
        class="btn btn-success btn-sm"
        (click)="show_add_note_form = true"
      >
        Add new note
      </button>
    </div>
  </div>
  <app-disciple-note-form
    *ngIf="show_add_note_form"
    [note]="selected_note"
    (close)="show_add_note_form = false; selected_note = undefined; getNotes()"
  >
  </app-disciple-note-form>
</div>
