<div class="container" style="min-height: 700px">
  <div class="row">
    <div *ngIf="show_header" class="col-12">
      <div class="card">
        <div class="card-fixed-text opacity-layer"></div>
        <div class="card-fixed-text row"></div>
        <img
          class="card-img-top card-img-top-fixed"
          src="/assets/img/videos_banner_new.png"
        />
      </div>
    </div>

    <div class="col-12" [hidden]="!show_loading">
      <ng-template [ngIf]="show_loading">
        <div class="d-flex justify-content-center" style="margin: 140px">
          <div
            class="spinner-border text-citric"
            style="width: 6rem; height: 6rem"
            role="status"
          ></div>
        </div>
      </ng-template>
    </div>

    <div class="col-12 p-0" *ngIf="display_form">
      <div class="row py-2">
        <h3 class="text-citric col-8">Serie Info</h3>
        <div class="col-4">
          <div class="btn-group float-right">
            <button class="btn btn-sm btn-outline-citric" (click)="closeForm()">
              Close
            </button>
          </div>
        </div>
      </div>
      <div class="card">
        <form #group_form="ngForm" [formGroup]="playlist_form">
          <div class="card-body">
            <div class="row">
              <div class="col-6">
                <div class="form-group">
                  <label>Title *</label>
                  <input
                    type="text"
                    required
                    class="form-control mb-1"
                    placeholder="Enter your series name."
                    formControlName="name"
                    [class.is-invalid]="
                      playlist_form.get('name').dirty &&
                      playlist_form.get('name').invalid
                    "
                  />
                </div>
              </div>
              <div class="col-6">
                <div class="card">
                  <div class="row card-body">
                    <img
                      [src]="fixUrl()"
                      [alt]="playlist_form.get('name').value"
                      class="group-picture mb-1"
                      (click)="uploadPicture(input_file)"
                    />
                    <span class="col-12" style="font-size: 12px">
                      Recommended size: 1000x428
                    </span>
                    <div class="col-9">
                      <button
                        type="button"
                        class="btn btn-sm btn-light"
                        (click)="uploadPicture(input_file)"
                      >
                        Upload image
                      </button>
                    </div>

                    <div class="col-12 col-md-4" [hidden]="true">
                      <div class="custom-file mb-4">
                        <input
                          #input_file
                          accept="image/*"
                          type="file"
                          class="custom-file-input"
                          id="customFile"
                        />
                        <label class="custom-file-label" for="customFile"
                          >Choose file</label
                        >
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-12">
                <div class="form-group">
                  <label>Description</label>
                  <textarea
                    type="text"
                    rows="3"
                    class="form-control mb-1"
                    placeholder="Tell about your serie. (optional)"
                    formControlName="description"
                    [class.is-invalid]="
                      playlist_form.get('description').dirty &&
                      playlist_form.get('description').invalid
                    "
                  >
                  </textarea>
                </div>
              </div>

              <div class="col-6 mb-3">
                <label>Videos Included</label>
                <ng-multiselect-dropdown
                  placeholder="Select the videos for this serie."
                  [data]="videos"
                  [settings]="select_options"
                  formControlName="videos"
                ></ng-multiselect-dropdown>
                <label>Audios Included</label>
                <ng-multiselect-dropdown
                  placeholder="Select the audios for this serie."
                  [data]="audios"
                  [settings]="select_options"
                  formControlName="audios"
                ></ng-multiselect-dropdown>
                <label>Documents Included</label>
                <ng-multiselect-dropdown
                  placeholder="Select the documents for this serie."
                  [data]="documents"
                  [settings]="select_options"
                  formControlName="documents"
                ></ng-multiselect-dropdown>
              </div>

              <div class="col-6 mb-3">
                <label>Featured Videos</label>
                <ng-multiselect-dropdown
                  placeholder="Select the featured videos for this serie."
                  [data]="selected_videos"
                  [settings]="select_options"
                  formControlName="featured_videos"
                ></ng-multiselect-dropdown>
              </div>

              <hr class="col-12" />

              <div class="col-12 mb-3">
                <h5>Settings</h5>
                <div class="form-group">
                  <label>Videos per row</label>
                  <select class="form-control" formControlName="videos_size">
                    <option disabled selected>-- Select an option --</option>
                    <option value="12">1 per row</option>
                    <option value="6">2 per row</option>
                    <option value="4">3 per row</option>
                    <option value="3">4 per row</option>
                  </select>
                </div>
                <div class="form-group">
                  <label>Audios per row</label>
                  <select class="form-control" formControlName="audios_size">
                    <option disabled selected>-- Select an option --</option>
                    <option value="12">1 per row</option>
                    <option value="6">2 per row</option>
                    <option value="4">3 per row</option>
                    <option value="3">4 per row</option>
                  </select>
                </div>
                <div class="form-group">
                  <label>Documents per row</label>
                  <select class="form-control" formControlName="documents_size">
                    <option disabled selected>-- Select an option --</option>
                    <option value="12">1 per row</option>
                    <option value="6">2 per row</option>
                    <option value="4">3 per row</option>
                    <option value="3">4 per row</option>
                  </select>
                </div>
              </div>

              <div class="col-12 text-center mt-3">
                <button
                  [disabled]="playlist_form.invalid"
                  type="button"
                  (click)="submitForm(playlist_form)"
                  class="btn btn-sm btn-success"
                >
                  Submit
                </button>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>

    <div
      *ngIf="!display_form && !show_loading"
      class="col-xs-12 col-md-12 mt-2 text-right row p-0"
    >
      <div class="col-8">
        <h4 class="text-citric text-left mb-2 mt-3">Manage Series</h4>
      </div>
      <div class="btn-group col-2 mb-2 mt-3">
        <button class="btn bt-sm btn-outline-success" (click)="addPlaylist()">
          Add serie
        </button>
      </div>
      <div class="btn-group col-2 mb-2 mt-3">
        <button class="btn bt-sm btn-citric" (click)="toggle_view.emit()">
          View Videos
        </button>
      </div>
    </div>
    <div
      *ngIf="!display_form && !show_loading"
      class="col-xs-12 col-md-12 mt-2 table-responsive-sm"
    >
      <!-- datatable
      [dtOptions]="dtOptions"
      [dtTrigger]="dtTrigger" -->
      <table class="table row-border hover mt-4">
        <thead>
          <tr>
            <th>Picture</th>
            <th>Title</th>
            <th>Desc.</th>
            <th>Settings</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let playlist of playlists">
            <td>
              <img
                [src]="fixUrlList(playlist.picture)"
                [alt]="playlist.name"
                class="responsive"
                onerror="this.onerror=null; this.src='/assets/img/default-image.jpg'"
              />
            </td>
            <td width="350" class="fixed">
              <b>{{ playlist.name }}</b>
            </td>
            <td class="fixed" style="max-width: 400px">
              {{ playlist.description }}
            </td>
            <td>
              <div class="btn-group">
                <!-- <button class="btn btn-sm btn-info" disabled>
                  <i class="fa fa-comments"></i>
                </button> -->
                <button
                  class="btn btn-secondary btn-sm"
                  (click)="
                    selected_id = playlist.idPlaylist;
                    embed_playlist_link.open()
                  "
                >
                  <i class="fa fa-link"></i>
                </button>
                <button
                  class="btn btn-sm btn-primary"
                  (click)="openPlaylistDetail(playlist)"
                >
                  <i class="fa fa-eye"></i>
                </button>
                <button
                  class="btn btn-success btn-sm"
                  (click)="editPlaylist(playlist)"
                >
                  <i class="fa fa-edit"></i>
                </button>
                <button
                  class="btn btn-danger btn-sm"
                  (click)="deletePlaylist(playlist)"
                >
                  <i class="fa fa-trash"></i>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="col-xs-12">
      <button class="btn btn-primary mb-2" (click)="iframeCodeModal.open()">
        <i class="fa fa-code"></i>
        Embed series
      </button>
    </div>
  </div>
</div>

<ngx-smart-modal #iframeCodeModal identifier="iframeCodeModal">
  <h4>Insert events on your page</h4>
  <pre style="background-color: e4e4e4; padding: 8px">
    {{ iframeCode.entry_point }}
  </pre>

  <div>Scripts</div>
  <pre style="background-color: #e4e4e4; padding: 8px">
    {{ iframeCode.scripts }}
  </pre>

  <div class="form-group mt-1">
    <label for="selectLang">Select language</label>
    <select class="form-control" id="selectLang" [(ngModel)]="iframeLang">
      <option value="en">English</option>
      <option value="es">Spanish</option>
    </select>
  </div>

  <p>Copy this code and paste it on your website</p>
</ngx-smart-modal>

<ngx-smart-modal #embed_playlist_link identifier="embed_playlist_link">
  <h4>Embed this form</h4>
  <div class="row justify-content-center">
    <div class="col-10 text-center">
      <small class="text-secondary">
        Share this QR with someone by clicking on it or ask to scan it using the
        app to join to the event.
      </small>
    </div>
    <div class="col-8 text-center">
      <ngx-qrcode
        #qr_code
        class="col-2"
        (click)="shareQR(qr_code)"
        style="width: 50px; height: 50px"
        [qrc-value]="iframeDetailCode.link"
        [qrc-class]="'qrItemResize-dash'"
        qrc-errorCorrectionLevel="M"
      >
      </ngx-qrcode>
      <button (click)="shareQR(qr_code)" class="btn btn-sm btn-citric">
        Copy QR
      </button>
    </div>
    <div class="col-12">
      <h5 class="text-center my-3">Or</h5>
      <small class="text-secondary mb-2">
        Copy this url and paste use it on you website
      </small>
      <pre
        class="mb-0"
        style="background-color: #e2e2e2; padding: 8px; white-space: normal"
      >
        <a [href]="iframeDetailCode.link" target="_blank">{{ iframeDetailCode.link }}</a>
      </pre>
    </div>
  </div>
</ngx-smart-modal>
